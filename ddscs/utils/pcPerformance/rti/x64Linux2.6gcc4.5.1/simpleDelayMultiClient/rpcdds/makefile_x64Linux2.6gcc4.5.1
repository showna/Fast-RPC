CPP_x64Linux2.6gcc4.5.1 = g++
CXXFLAGS_x64Linux2.6gcc4.5.1 = -m64 -std=c++0x
LD_x64Linux2.6gcc4.5.1 = g++
LDFLAGS_x64Linux2.6gcc4.5.1 = -m64
SYSLIBS_x64Linux2.6gcc4.5.1 = -ldl -lnsl -lm -lpthread -lrt
DEFINES_ARCH_SPECIFIC =  -DRTI_UNIX -DRTI_LINUX

DEFINES = $(DEFINES_ARCH_SPECIFIC)  

INCLUDES = -I.  -I$(NDDSHOME)/include -I$(NDDSHOME)/include/ndds -I../../../../../../include -I../../../../../../include/idl/rti

LIBS =  -L$(NDDSHOME)/lib/x64Linux2.6gcc4.5.1 -L../../../../../../lib/x64Linux2.6gcc4.5.1 \
       -lboost_chrono-mt -lboost_system-mt -lboost_thread-mt -lnddsc -lnddscore -lnddscpp -lrpcdds $(SYSLIBS_x64Linux2.6gcc4.5.1)

COMMONCXXSOURCES = SimpleDelayRequestReply.cxx SimpleDelay.cxx SimpleDelayRequestReplyPlugin.cxx \
                SimpleDelayPlugin.cxx SimpleDelayRequestReplySupport.cxx SimpleDelaySupport.cxx \
                SimpleDelayRequestReplyUtils.cxx MessageHeader.cxx MessageHeaderPlugin.cxx \
                MessageHeaderSupport.cxx
COMMONCPPSOURCES =

CLIENTSOURCES = SimpleDelayProxy.cxx SimpleDelayClientRPCSupport.cxx SimpleDelayAsyncSupport.cxx Client.cxx 
SERVERSOURCES = SimpleDelayServer.cxx SimpleDelayServerImpl.cxx SimpleDelayServerRPCSupport.cxx Server.cxx 
DIRECTORIES   = objs.dir objs/x64Linux2.6gcc4.5.1.dir
COMMONOBJS    = $(COMMONCXXSOURCES:%.cxx=objs/x64Linux2.6gcc4.5.1/%.o) $(COMMONCPPSOURCES:%.cpp=objs/x64Linux2.6gcc4.5.1/%.o)
CLIENTOBJS    = $(CLIENTSOURCES:%.cxx=objs/x64Linux2.6gcc4.5.1/%.o)
SERVEROBJS    = $(SERVERSOURCES:%.cxx=objs/x64Linux2.6gcc4.5.1/%.o)
CLIENTEXEC    = objs/x64Linux2.6gcc4.5.1/SimpleDelayClient
SERVEREXEC    = objs/x64Linux2.6gcc4.5.1/SimpleDelayServer

client: $(DIRECTORIES) $(COMMONOBJS) $(CLIENTOBJS) $(CLIENTEXEC)
server: $(DIRECTORIES) $(COMMONOBJS) $(SERVEROBJS) $(SERVEREXEC)

$(CLIENTEXEC) : 
	$(LD_x64Linux2.6gcc4.5.1) $(LDFLAGS_x64Linux2.6gcc4.5.1)  -o $(@:%.out=%) $(COMMONOBJS) $(CLIENTOBJS) $(LIBS)

$(SERVEREXEC) : 
	$(LD_x64Linux2.6gcc4.5.1) $(LDFLAGS_x64Linux2.6gcc4.5.1)  -o $(@:%.out=%) $(COMMONOBJS) $(SERVEROBJS) $(LIBS)

objs/x64Linux2.6gcc4.5.1/%.o : %.cxx
	$(CPP_x64Linux2.6gcc4.5.1) $(CXXFLAGS_x64Linux2.6gcc4.5.1)  -o $@ $(DEFINES) $(INCLUDES) -c $<
	
objs/x64Linux2.6gcc4.5.1/%.o : %.cpp
	$(CPP_x64Linux2.6gcc4.5.1) $(CXXFLAGS_x64Linux2.6gcc4.5.1)  -o $@ $(DEFINES) $(INCLUDES) -c $<

# Here is how we create those subdirectories automatically.
%.dir : 
	@echo "Checking directory $*"
	@if [ ! -d $* ]; then \
		echo "Making directory $*"; \
		mkdir -p $* ; \
	fi;
